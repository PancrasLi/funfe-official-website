import{h as m,l as ue,A as oe,o as d,c,m as l,n as j,t as p,F as w,G as N,Q as A,a5 as de,a8 as ce,e as T,a2 as ve,a as me,a4 as pe,J as fe}from"./chunks/framework.B3gFn30p.js";const ye={class:"playground"},be={class:"playground-header"},_e={class:"mode-switch"},ge={class:"actions"},he=["disabled"],ke={class:"playground-main"},xe={class:"editor-area"},we={class:"blocks-panel"},Ne={class:"category-blocks"},Ce=["onClick"],Be={class:"workspace"},Ee=["onDragstart","onDragover"],De={class:"block-text"},Ae=["type","onUpdate:modelValue","placeholder"],Te=["onClick"],Me={key:0,class:"workspace-empty"},Ve={key:1,class:"code-view"},Fe={class:"stage"},Le=l("div",{class:"stage-header"}," 舞台 ",-1),Se={class:"stage-content"},$e={key:0,class:"speech-bubble"},Pe={class:"stage-info"},je={key:0,class:"help-modal"},Ue={class:"help-content"},Ie=pe("",2),Oe={__name:"Playground",setup(Z){const _=m("blocks"),M=m(""),i=m({x:0,y:0,direction:90,costume:"🐱",visible:!0}),f=m(!1),C=m([{name:"score",value:0},{name:"lives",value:3}]),y=[{category:"动作",color:"#4C97FF",items:[{id:"move",text:"移动 [N] 步",params:[{type:"number",default:10}]},{id:"turn",text:"旋转 [N] 度",params:[{type:"number",default:90}]},{id:"goto",text:"移到 x: [X] y: [Y]",params:[{type:"number",default:0},{type:"number",default:0}]}]},{category:"外观",color:"#9966FF",items:[{id:"say",text:"说 [TEXT]",params:[{type:"text",default:"你好！"}]},{id:"show",text:"显示"},{id:"hide",text:"隐藏"},{id:"change_costume",text:"换装扮为 [COSTUME]",params:[{type:"select",options:["🐱","🐶","🐰","🐸"],default:"🐱"}]}]},{category:"控制",color:"#FFAB19",items:[{id:"wait",text:"等待 [N] 秒",params:[{type:"number",default:1}]},{id:"repeat",text:"重复 [N] 次",params:[{type:"number",default:10}]},{id:"forever",text:"重复执行",isContainer:!0},{id:"if",text:"如果 [COND] 那么",params:[{type:"condition"}],isContainer:!0},{id:"if_else",text:"如果 [COND] 那么/否则",params:[{type:"condition"}],isContainer:!0,hasElse:!0}]},{category:"侦测",color:"#4CBFE6",items:[{id:"touching_edge",text:"碰到边缘?"},{id:"mouse_down",text:"鼠标按下?"},{id:"key_pressed",text:"按下键 [KEY]?",params:[{type:"select",options:["空格","上","下","左","右"],default:"空格"}]}]},{category:"运算",color:"#40BF4A",items:[{id:"add",text:"[A] + [B]",params:[{type:"number",default:0},{type:"number",default:0}]},{id:"subtract",text:"[A] - [B]",params:[{type:"number",default:0},{type:"number",default:0}]},{id:"multiply",text:"[A] × [B]",params:[{type:"number",default:0},{type:"number",default:0}]},{id:"divide",text:"[A] ÷ [B]",params:[{type:"number",default:1},{type:"number",default:1}]},{id:"greater",text:"[A] > [B]",params:[{type:"number",default:0},{type:"number",default:0}]},{id:"less",text:"[A] < [B]",params:[{type:"number",default:0},{type:"number",default:0}]},{id:"equals",text:"[A] = [B]",params:[{type:"number",default:0},{type:"number",default:0}]}]},{category:"变量",color:"#FF8C1A",items:[{id:"set_var",text:"设置变量 [VAR] 为 [VALUE]",params:[{type:"variable"},{type:"number",default:0}]},{id:"change_var",text:"改变变量 [VAR] 增加 [VALUE]",params:[{type:"variable"},{type:"number",default:1}]},{id:"get_var",text:"变量 [VAR] 的值",params:[{type:"variable"}]}]}],u=m([]),B=m({text:"",visible:!1}),E=m(-1);function V(e){var t;const s={...e,id:e.id,text:e.text,params:((t=e.params)==null?void 0:t.map(r=>({...r,value:r.default})))||[]};u.value.push(s),F()}function U(e){u.value.splice(e,1),F()}function F(){M.value=u.value.map(e=>{var t;const s=((t=e.params)==null?void 0:t.map(r=>r.value).join(", "))||"";return`${e.id}(${s});`}).join(`
`)}async function I(){if(!f.value){f.value=!0;for(const e of u.value)try{await h(e)}catch(s){console.error("执行错误:",s)}f.value=!1}}const g=m(-1);function ee(e,s){g.value=s,e.target.classList.add("dragging")}function ae(e,s){e.preventDefault();const t=u.value[g.value];if(g.value!==s&&t){const r=[...u.value];r.splice(g.value,1),r.splice(s,0,t),u.value=r,g.value=s}}function te(e){e.target.classList.remove("dragging"),g.value=-1,F()}async function h(e,s){var t,r,k,v,x;switch(E.value=s,e.id){case"move":const D=Number(e.params[0].value),q=i.value.direction*Math.PI/180,se=i.value.x+Math.cos(q)*D,le=i.value.y+Math.sin(q)*D,z=i.value.x,G=i.value.y,P=20;for(let a=0;a<=P;a++)i.value.x=z+(se-z)*(a/P),i.value.y=G+(le-G)*(a/P),await new Promise(n=>setTimeout(n,20));break;case"turn":const ie=Number(e.params[0].value),ne=i.value.direction,J=20;for(let a=0;a<=J;a++)i.value.direction=ne+ie*(a/J),await new Promise(n=>setTimeout(n,20));break;case"goto":i.value.x=Number(e.params[0].value),i.value.y=Number(e.params[1].value);break;case"say":B.value={text:e.params[0].value,visible:!0},await new Promise(a=>setTimeout(a,2e3)),B.value.visible=!1;break;case"show":i.value.visible=!0;break;case"hide":i.value.visible=!1;break;case"wait":await new Promise(a=>setTimeout(a,Number(e.params[0].value)*1e3));break;case"repeat":const re=Number(e.params[0].value);for(let a=0;a<re;a++)for(let n=s+1;n<u.value.length;n++){const o=u.value[n];if((t=y.find(b=>b.category==="控制"))!=null&&t.items.some(b=>b.id===o.id))break;await h(o,n)}break;case"change_costume":i.value.costume=e.params[0].value;break;case"forever":for(;f.value;)for(let a=s+1;a<u.value.length&&f.value;a++){const n=u.value[a];if((r=y.find(o=>o.category==="控制"))!=null&&r.items.some(o=>o.id===n.id))break;await h(n,a)}break;case"if":if(evaluateCondition(e.params[0].value))for(let a=s+1;a<u.value.length;a++){const n=u.value[a];if((k=y.find(o=>o.category==="控制"))!=null&&k.items.some(o=>o.id===n.id))break;await h(n,a)}break;case"if_else":if(evaluateCondition(e.params[0].value))for(let a=s+1;a<u.value.length;a++){const n=u.value[a];if(n.id==="else"||(v=y.find(o=>o.category==="控制"))!=null&&v.items.some(o=>o.id===n.id))break;await h(n,a)}else{let a=!1;for(let n=s+1;n<u.value.length;n++){const o=u.value[n];if(!a){o.id==="else"&&(a=!0);continue}if((x=y.find(b=>b.category==="控制"))!=null&&x.items.some(b=>b.id===o.id))break;await h(o,n)}}break;case"add":return Number(e.params[0].value)+Number(e.params[1].value);case"subtract":return Number(e.params[0].value)-Number(e.params[1].value);case"multiply":return Number(e.params[0].value)*Number(e.params[1].value);case"divide":return Number(e.params[0].value)/Number(e.params[1].value);case"greater":return Number(e.params[0].value)>Number(e.params[1].value);case"less":return Number(e.params[0].value)<Number(e.params[1].value);case"equals":return Number(e.params[0].value)===Number(e.params[1].value);case"set_var":const H=C.value.find(a=>a.name===e.params[0].value);H&&(H.value=Number(e.params[1].value));break;case"change_var":const Q=C.value.find(a=>a.name===e.params[0].value);Q&&(Q.value+=Number(e.params[1].value));break;case"get_var":const W=C.value.find(a=>a.name===e.params[0].value);return W?W.value:0;case"touching_edge":return Math.abs(i.value.x)>180||Math.abs(i.value.y)>140;case"mouse_down":return L.value;case"key_pressed":return S.has(e.params[0].value)}E.value=-1}const L=m(!1),S=m(new Set);function O(e){if(e.code==="Space")e.preventDefault(),f.value||I();else if(e.code==="Delete"||e.code==="Backspace"){const s=u.value.findIndex((t,r)=>r===E.value);s!==-1&&U(s)}S.value.add(e.key)}function R(e){S.value.delete(e.key)}function K(){L.value=!0}function X(){L.value=!1}function Y(){i.value={x:0,y:0,direction:90,costume:"🐱",visible:!0},f.value=!1}const $=m(!1);return ue(()=>{Y(),V({id:"move",text:"移动 [N] 步",params:[{type:"number",default:10}]}),V({id:"turn",text:"旋转 [N] 度",params:[{type:"number",default:90}]}),window.addEventListener("keydown",O),window.addEventListener("keyup",R),window.addEventListener("mousedown",K),window.addEventListener("mouseup",X)}),oe(()=>{window.removeEventListener("keydown",O),window.removeEventListener("keyup",R),window.removeEventListener("mousedown",K),window.removeEventListener("mouseup",X)}),(e,s)=>(d(),c("div",ye,[l("div",be,[l("div",_e,[l("button",{class:j(["mode-btn",{active:_.value==="blocks"}]),onClick:s[0]||(s[0]=t=>_.value="blocks")}," 图形编程 ",2),l("button",{class:j(["mode-btn",{active:_.value==="code"}]),onClick:s[1]||(s[1]=t=>_.value="code")}," 代码模式 ",2)]),l("div",ge,[l("button",{class:"action-btn",onClick:s[2]||(s[2]=t=>$.value=!0)}," 使用说明 "),l("button",{class:"action-btn primary",disabled:f.value,onClick:I},p(f.value?"运行中...":"运行"),9,he),l("button",{class:"action-btn",onClick:Y}," 重置 ")])]),l("div",ke,[l("div",xe,[_.value==="blocks"?(d(),c(w,{key:0},[l("div",we,[(d(),c(w,null,N(y,t=>l("div",{key:t.category,class:"block-category"},[l("div",{class:"category-header",style:A({backgroundColor:t.color})},p(t.category),5),l("div",Ne,[(d(!0),c(w,null,N(t.items,r=>(d(),c("div",{key:r.id,class:"block",style:A({backgroundColor:t.color}),onClick:k=>V(r)},p(r.text),13,Ce))),128))])])),64))]),l("div",Be,[(d(!0),c(w,null,N(u.value,(t,r)=>{var k;return d(),c("div",{key:t.id,class:j(["workspace-block",{active:r===E.value}]),draggable:"true",onDragstart:v=>ee(v,r),onDragover:v=>ae(v,r),onDragend:te},[l("div",{class:"block",style:A({backgroundColor:(k=y.find(v=>v.items.some(x=>x.id===t.id)))==null?void 0:k.color})},[l("span",De,p(t.text),1),t.params?(d(!0),c(w,{key:0},N(t.params,(v,x)=>de((d(),c("input",{key:x,type:v.type==="number"?"number":"text","onUpdate:modelValue":D=>v.value=D,placeholder:v.default,class:"block-input"},null,8,Ae)),[[ce,v.value]])),128)):T("",!0),l("button",{class:"remove-block",onClick:ve(v=>U(r),["stop"])}," × ",8,Te)],4)],42,Ee)}),128)),u.value.length?T("",!0):(d(),c("div",Me," 从左侧拖入积木块开始编程 "))])],64)):(d(),c("div",Ve,[l("pre",null,p(M.value),1)]))]),l("div",Fe,[Le,l("div",Se,[l("div",{class:"sprite",style:A({transform:`translate(${i.value.x}px, ${i.value.y}px) rotate(${i.value.direction}deg)`,display:i.value.visible?"block":"none"})},[me(p(i.value.costume)+" ",1),B.value.visible?(d(),c("div",$e,p(B.value.text),1)):T("",!0)],4)]),l("div",Pe,[l("span",null,"x: "+p(Math.round(i.value.x)),1),l("span",null,"y: "+p(Math.round(i.value.y)),1),l("span",null,"方向: "+p(Math.round(i.value.direction))+"°",1),(d(!0),c(w,null,N(C.value,t=>(d(),c("span",{key:t.name},p(t.name)+": "+p(t.value),1))),128))])])]),$.value?(d(),c("div",je,[l("div",Ue,[Ie,l("button",{class:"action-btn",onClick:s[3]||(s[3]=t=>$.value=!1)}," 知道了 ")])])):T("",!0)]))}},qe=JSON.parse('{"title":"少儿编程工具","description":"","frontmatter":{"layout":"page","title":"少儿编程工具","aside":false},"headers":[],"relativePath":"playground/index.md","filePath":"playground/index.md","lastUpdated":1737621672000}'),Re={name:"playground/index.md"},ze=Object.assign(Re,{setup(Z){return(_,M)=>(d(),c("div",null,[fe(Oe)]))}});export{qe as __pageData,ze as default};
