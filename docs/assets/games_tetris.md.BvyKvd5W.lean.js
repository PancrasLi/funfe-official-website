import{_ as P,h as i,l as A,c as R,m as o,t as M,o as W,q as D,s as N,a as G}from"./chunks/framework.B3gFn30p.js";const U=u=>(D("data-v-a3de3cdc"),u=u(),N(),u),V=U(()=>o("h1",{id:"俄罗斯方块",tabindex:"-1"},[G("俄罗斯方块 "),o("a",{class:"header-anchor",href:"#俄罗斯方块","aria-label":'Permalink to "俄罗斯方块"'},"​")],-1)),j={class:"game-container"},q={class:"score"},z=["width","height"],F=JSON.parse('{"title":"俄罗斯方块","description":"","frontmatter":{},"headers":[],"relativePath":"games/tetris.md","filePath":"games/tetris.md","lastUpdated":1736921119000}'),H={name:"games/tetris.md"},J=Object.assign(H,{setup(u){const v=i(null),r=i(null),f=i(null),d=i(0),O=[[[1,1,1,1]],[[1,1],[1,1]],[[1,1,1],[0,1,0]],[[1,1,1],[1,0,0]],[[1,1,1],[0,0,1]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]]],a=i(null),s=i([]);function y(){r.value=v.value.getContext("2d"),C(),h(),document.addEventListener("keydown",w),_()}function C(){s.value=Array(20).fill().map(()=>Array(10).fill(0))}function h(){const e=O[Math.floor(Math.random()*O.length)];a.value={shape:e,x:Math.floor(10/2)-Math.floor(e[0].length/2),y:0}}function L(){r.value.clearRect(0,0,v.value.width,v.value.height),g(),I()}function g(){s.value.forEach((e,t)=>{e.forEach((n,l)=>{n&&(r.value.fillStyle="#777",r.value.fillRect(l*30,t*30,29,29))})})}function I(){r.value.fillStyle="#f00",a.value.shape.forEach((e,t)=>{e.forEach((n,l)=>{n&&r.value.fillRect((a.value.x+l)*30,(a.value.y+t)*30,29,29)})})}function w(e){switch(e.key){case"ArrowLeft":c(-1,0)&&a.value.x--;break;case"ArrowRight":c(1,0)&&a.value.x++;break;case"ArrowDown":c(0,1)&&a.value.y++;break;case"ArrowUp":B();break}L()}function c(e,t){return a.value.shape.every((n,l)=>n.every((p,b)=>{const S=a.value.x+b+e,m=a.value.y+l+t;return p===0||S>=0&&S<10&&m<20&&(m<0||s.value[m][S]===0)}))}function B(){const e=a.value.shape[0].map((n,l)=>a.value.shape.map(p=>p[l]).reverse()),t=a.value.shape;a.value.shape=e,c(0,0)||(a.value.shape=t)}function x(){c(0,1)?a.value.y++:(k(),K(),h(),c(0,0)||Z()),L()}function k(){a.value.shape.forEach((e,t)=>{e.forEach((n,l)=>{n&&(s.value[a.value.y+t][a.value.x+l]=n)})})}function K(){let e=0;for(s.value=s.value.filter(t=>{const n=t.every(l=>l===1);return n&&e++,!n});e>0;)s.value.unshift(Array(10).fill(0)),d.value+=100*e,e--}function _(){f.value||(f.value=setInterval(x,1e3))}function Z(){clearInterval(f.value),f.value=null,alert(`游戏结束！得分：${d.value}`),E()}function E(){d.value=0,C(),h(),_()}return A(()=>{y()}),(e,t)=>(W(),R("div",null,[V,o("div",j,[o("div",q,"得分："+M(d.value),1),o("canvas",{ref_key:"canvas",ref:v,width:10*30,height:20*30,class:"game-canvas"},null,8,z),o("div",{class:"controls"},[o("button",{onClick:_},"开始游戏"),o("button",{onClick:E},"重新开始")])])]))}}),Q=P(J,[["__scopeId","data-v-a3de3cdc"]]);export{F as __pageData,Q as default};
